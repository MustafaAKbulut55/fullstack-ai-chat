# ============================================================
# ğŸ³ Dockerfile - SentimentAPI
# Bu dosya, .NET 8 tabanlÄ± duygu analizi APIâ€™sinin container ortamÄ±nda
# Ã§alÄ±ÅŸtÄ±rÄ±lmasÄ± iÃ§in gerekli adÄ±mlarÄ± tanÄ±mlar.
#
# Ä°ki aÅŸamalÄ± (multi-stage) yapÄ± kullanÄ±lmÄ±ÅŸtÄ±r:
#   1ï¸âƒ£ Build aÅŸamasÄ±: Uygulama derlenir ve yayÄ±nlanÄ±r.
#   2ï¸âƒ£ Runtime aÅŸamasÄ±: YalnÄ±zca yayÄ±n dosyalarÄ±yla hafif bir imaj oluÅŸturulur.
# ============================================================

# ------------------------------------------------------------
# 1ï¸âƒ£ BUILD AÅAMASI
# .NET SDK imajÄ± kullanÄ±larak projenin restore ve publish iÅŸlemleri yapÄ±lÄ±r.
# ------------------------------------------------------------
FROM mcr.microsoft.com/dotnet/sdk:8.0 AS build

# Ã‡alÄ±ÅŸma dizinini oluÅŸtur ve iÃ§ine geÃ§
WORKDIR /app

# TÃ¼m proje dosyalarÄ±nÄ± container iÃ§ine kopyala
COPY . ./

# Gerekli baÄŸÄ±mlÄ±lÄ±klarÄ± indir (NuGet restore)
RUN dotnet restore

# UygulamayÄ± "Release" modunda derle ve Ã§Ä±ktÄ±yÄ± "out" klasÃ¶rÃ¼ne al
RUN dotnet publish -c Release -o out

# ------------------------------------------------------------
# 2ï¸âƒ£ RUNTIME AÅAMASI
# Bu aÅŸama, sadece derlenmiÅŸ Ã§Ä±ktÄ±larÄ± kullanÄ±r.
# SDK iÃ§ermediÄŸi iÃ§in imaj boyutu kÃ¼Ã§Ã¼ktÃ¼r (daha gÃ¼venli ve performanslÄ±dÄ±r).
# ------------------------------------------------------------
FROM mcr.microsoft.com/dotnet/aspnet:8.0

# Ã‡alÄ±ÅŸma dizinini ayarla
WORKDIR /app

# Build aÅŸamasÄ±nda oluÅŸturulan dosyalarÄ± kopyala
COPY --from=build /app/out .

# Container baÅŸlatÄ±ldÄ±ÄŸÄ±nda Ã§alÄ±ÅŸacak komut
ENTRYPOINT ["dotnet", "SentimentAPI.dll"]

# ------------------------------------------------------------
# ğŸ“Œ Ã–ZET:
#  - Bu yapÄ± Render, Docker Hub veya Azure Container App gibi ortamlarda
#    SentimentAPI projesini kolayca daÄŸÄ±tmanÄ± saÄŸlar.
#  - Uygulama, .NET 8 runtime Ã¼zerinde Ã§alÄ±ÅŸÄ±r.
#  - Build ve runtime ayrÄ±mÄ± sayesinde gereksiz dosyalar imaja dahil edilmez.
# ------------------------------------------------------------
